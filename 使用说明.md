# 哔哩哔哩自动任务脚本使用说明

## 项目简介

本项目是一个基于Node.js开发的哔哩哔哩（B站）自动化脚本，适用于青龙面板，可以帮助用户自动完成以下任务：

- 每日观看视频
- 每日分享视频
- 每日投币（可配置数量）
- 直播签到
- 漫画签到
- 大会员权益领取

本脚本特点：
- 模拟真实用户行为，包括随机延时和UA
- 支持多账号
- 任务执行结果通知推送
- 可灵活配置任务参数

## 使用方法

### 一、环境准备

1. **安装Node.js环境**
   青龙面板通常已经内置了Node.js环境，无需额外安装。

2. **安装依赖包**
   在青龙面板的"依赖管理"页面，添加以下npm依赖：
   ```
   axios
   crypto-js
   tough-cookie
   moment
   ```

### 二、脚本部署

1. **将脚本上传到青龙面板**
   - 将本项目文件上传到青龙面板的`/ql/scripts/`目录下
   - 也可以通过添加订阅的方式拉取最新脚本

2. **配置环境变量**
   在青龙面板"环境变量"中添加：

   - **必需变量**：
     - `BILIBILI_COOKIE` : B站Cookie，多账号用`&`分隔

   - **可选变量**：
     - `BILIBILI_PUSH` : 推送渠道设置，例如：`pushplus`

### 三、获取B站Cookie

1. 登录 [哔哩哔哩](https://www.bilibili.com) 网站
2. 按F12打开开发者工具，切换到"应用程序"或"Application"选项卡
3. 在左侧找到"Cookie"，点击展开并选择"https://www.bilibili.com"
4. 在右侧找到名为`SESSDATA`、`bili_jct`和`DedeUserID`的Cookie
5. 提取这些Cookie的值，格式为：
   ```
   DedeUserID=你的ID; DedeUserID__ckMd5=你的值; SESSDATA=你的值; bili_jct=你的值;
   ```

### 四、配置定时任务

在青龙面板的"定时任务"页面添加以下任务：

1. **全部任务一起运行**
   ```
   5 8 * * * cd /ql/scripts/bilibili_qinglong && node index.js
   ```

2. **分别运行各个任务**
   ```
   0 8 * * * cd /ql/scripts/bilibili_qinglong && node tasks/dailyTasks.js
   10 8 * * * cd /ql/scripts/bilibili_qinglong && node tasks/liveSign.js
   20 8 * * * cd /ql/scripts/bilibili_qinglong && node tasks/mangaSign.js
   30 8 * * * cd /ql/scripts/bilibili_qinglong/tasks/vipTask.js
   ```

### 五、高级配置

如需自定义配置，可编辑`utils/config.js`文件，主要配置项包括：

- **任务配置**：控制是否执行某项任务、投币数量等
- **模拟行为配置**：控制随机延迟、UA等
- **推送配置**：控制消息推送方式及参数
- **调试配置**：控制日志输出级别等

## 常见问题

### 1. 脚本运行报错

- **问题**: `Error: Cannot find module 'xxx'`
- **解决方案**: 请检查是否已安装相应依赖，可在青龙面板"依赖管理"中添加。

### 2. Cookie无效

- **问题**: 提示"登录失效"或"获取用户信息失败"
- **解决方案**: 重新获取最新Cookie并更新环境变量。B站Cookie通常有效期为一个月左右。

### 3. 投币任务失败

- **问题**: 提示"硬币余额不足"
- **解决方案**: 在配置文件中调低每日投币数量，默认为5个。

### 4. 消息推送失败

- **问题**: 通知未收到或报错
- **解决方案**: 检查推送渠道相关配置是否正确，如Token等。

## 免责声明

1. 本项目仅用于学习交流，请勿用于商业用途
2. 使用本脚本产生的所有后果由使用者自行承担
3. 请不要将Cookie等敏感信息泄露给他人
4. 请适度使用脚本，不要频繁调用API，避免对B站服务器造成负担

## 参考资料

本项目参考了 [哔哩哔哩-API收集整理](https://github.com/SocialSisterYi/bilibili-API-collect) 的相关API文档。 